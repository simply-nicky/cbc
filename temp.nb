(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11268,        329]
NotebookOptionsPosition[     10106,        301]
NotebookOutlinePosition[     10460,        317]
CellTagsIndexPosition[     10417,        314]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"w0", "=", 
    SuperscriptBox["10", 
     RowBox[{"-", "4"}]]}], ";", 
   RowBox[{"(*", 
    RowBox[{"waist", " ", "width"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"\[Lambda]0", "=", 
    RowBox[{"1.5", " ", 
     SuperscriptBox["10", 
      RowBox[{"-", "7"}]]}]}], ";"}], 
  RowBox[{"(*", "wavelength", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]div", " ", "[", 
   RowBox[{
    RowBox[{"w_:", "w0"}], ",", 
    RowBox[{"\[Lambda]_:", "\[Lambda]0"}]}], "]"}], ":=", " ", 
  RowBox[{"\[Lambda]", "/", 
   RowBox[{"(", 
    RowBox[{"\[Pi]", " ", "w"}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", "[", 
   RowBox[{"\[Lambda]_:", "\[Lambda]0"}], "]"}], ":=", 
  RowBox[{"2", 
   RowBox[{"\[Pi]", "/", "\[Lambda]"}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"zr", "[", 
    RowBox[{
     RowBox[{"\[Lambda]_:", "\[Lambda]0"}], ",", 
     RowBox[{"w_:", "w0"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"k", "[", "\[Lambda]", "]"}], 
    RowBox[{
     SuperscriptBox["w", "2"], "/", "2"}]}]}], 
  RowBox[{"(*", 
   RowBox[{"rayleight", " ", "length"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wz", "[", 
   RowBox[{"z_", ",", 
    RowBox[{"\[Lambda]_:", "\[Lambda]0"}], ",", 
    RowBox[{"w_:", "w0"}]}], "]"}], ":=", 
  RowBox[{"w", 
   SqrtBox[
    RowBox[{"1", "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z", "/", 
        RowBox[{"zr", "[", 
         RowBox[{"\[Lambda]", ",", "w"}], "]"}]}], ")"}], 
      "2"]}]]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", "[", 
   RowBox[{"z_", ",", 
    RowBox[{"\[Lambda]_:", "\[Lambda]0"}], ",", 
    RowBox[{"w_:", "w0"}]}], "]"}], ":=", 
  RowBox[{"z", "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"zr", "[", 
      RowBox[{"\[Lambda]", ",", "w"}], "]"}], "2"], "/", 
    "z"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "[", 
   RowBox[{"x_", ",", "y_", ",", "z_", ",", 
    RowBox[{"\[Lambda]_:", "\[Lambda]0"}], ",", 
    RowBox[{"w_:", "w0"}]}], "]"}], ":=", 
  RowBox[{
   SqrtBox[
    RowBox[{"2", "/", "\[Pi]"}]], 
   SuperscriptBox[
    RowBox[{"wz", "[", 
     RowBox[{"z", ",", "\[Lambda]", ",", "w"}], "]"}], 
    RowBox[{"-", "1"}]], 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", 
      RowBox[{"k", "[", "\[Lambda]", "]"}], " ", "z"}], " ", "+", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"ArcTan", "[", 
       RowBox[{"z", "/", 
        RowBox[{"zr", "[", 
         RowBox[{"\[Lambda]", ",", "w"}], "]"}]}], "]"}]}]}], "]"}], 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"]}], ")"}]}], "/", 
     SuperscriptBox[
      RowBox[{"wz", "[", 
       RowBox[{"z", ",", "\[Lambda]", ",", "w"}], "]"}], "2"]}], "]"}], 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], " ", 
     RowBox[{"k", "[", "\[Lambda]", "]"}], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", 
        RowBox[{"R", "[", 
         RowBox[{"z", ",", "\[Lambda]", ",", "w"}], "]"}]}], ")"}]}]}], "]"}], 
   RowBox[{"(*", 
    RowBox[{"Gaussian", " ", "beam"}], "*)"}]}]}]}], "Input",
 CellChangeTimes->{{3.7543844159463253`*^9, 3.754384472873629*^9}, {
  3.754384525456311*^9, 3.75438452619654*^9}, {3.754391115917818*^9, 
  3.7543911603865557`*^9}, {3.756121306806624*^9, 3.756121323975976*^9}, {
  3.7577459781837597`*^9, 3.757746053746887*^9}, {3.7577463030867023`*^9, 
  3.757746329579693*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"69075920-6dc6-486e-acfa-ba9cdcd8dab2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{"u", "[", " ", 
   RowBox[{
    SuperscriptBox["10", 
     RowBox[{"-", "3"}]], ",", 
    SuperscriptBox["10", 
     RowBox[{"-", "3"}]], ",", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.754384545709978*^9, 3.7543845466265574`*^9}, {
  3.7543887098744*^9, 3.75438878375095*^9}, {3.7543888277414618`*^9, 
  3.754388847325296*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"fd533328-08c6-4a11-86a0-bb78c8e5d37b"],

Cell[BoxData[
 RowBox[{"0.1884838440711432`", "\[VeryThinSpace]", "+", 
  RowBox[{"0.313973996556035`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{
  3.7543845473977423`*^9, {3.7543887278232327`*^9, 3.754388785689043*^9}, {
   3.754388830924618*^9, 3.754388848091154*^9}, 3.757746339320901*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"590bd861-4bc0-4524-9423-b9bd31f0aee0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalDelta]r", "=", 
    RowBox[{"3", " ", 
     SuperscriptBox["10", 
      RowBox[{"-", "7"}]]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"minimum", " ", "detectable", " ", "size"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lsample", "=", 
    RowBox[{"150", " ", 
     SuperscriptBox["10", 
      RowBox[{"-", "6"}]]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"sample", " ", "size"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fmax", "=", 
    RowBox[{"ArcSin", "[", " ", 
     FractionBox["\[Lambda]", "\[CapitalDelta]r"], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"maximum", " ", "spatial", " ", "frequency"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fs", "=", 
    RowBox[{"ArcSin", "[", 
     FractionBox["\[Lambda]", "lsample"], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"sampling", " ", "rate"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lpix", "=", 
    RowBox[{"55", "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "3"}]]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"LAMBDA", " ", "detector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ldet", "=", 
    RowBox[{"512", "*", "lpix"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"LAMBDA", " ", "detector"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"d1", "=", 
  RowBox[{"lpix", "/", "fs"}]}], "\[IndentingNewLine]", 
 RowBox[{"d2", "=", 
  RowBox[{"ldet", "/", "fmax"}]}]}], "Input",
 CellChangeTimes->{{3.75439057683747*^9, 3.754390643073053*^9}, {
  3.754390874162218*^9, 3.754390874363056*^9}, {3.754390941078334*^9, 
  3.7543910062033167`*^9}, {3.7543912000121326`*^9, 3.754391307909068*^9}, {
  3.754392045773509*^9, 3.754392095284562*^9}, {3.754392166766171*^9, 
  3.75439235424846*^9}, {3.7543924359146852`*^9, 3.754392436227749*^9}, {
  3.7543927418397007`*^9, 3.754392749059573*^9}, {3.7543928856951847`*^9, 
  3.754392916416211*^9}, {3.75439298927509*^9, 3.754393006349587*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"9a137cdd-f24b-4eb0-9651-220582abbfc9"],

Cell[BoxData["54.999990833330735`"], "Output",
 CellChangeTimes->{
  3.754392227091907*^9, {3.754392308002945*^9, 3.754392355030469*^9}, 
   3.754392436644507*^9, {3.7543927425727253`*^9, 3.754392749477214*^9}, {
   3.7543928860111837`*^9, 3.754392918391685*^9}, {3.754392989836026*^9, 
   3.7543930067675543`*^9}},
 CellLabel->
  "Out[101]=",ExpressionUUID->"d75aadc5-44d3-44e9-913d-c889fc24e835"],

Cell[BoxData["53.781638369613276`"], "Output",
 CellChangeTimes->{
  3.754392227091907*^9, {3.754392308002945*^9, 3.754392355030469*^9}, 
   3.754392436644507*^9, {3.7543927425727253`*^9, 3.754392749477214*^9}, {
   3.7543928860111837`*^9, 3.754392918391685*^9}, {3.754392989836026*^9, 
   3.7543930067751083`*^9}},
 CellLabel->
  "Out[102]=",ExpressionUUID->"af47f7d0-9eea-4da0-aa34-4093d8c7838a"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"2", " ", 
    SuperscriptBox["10", 
     RowBox[{"-", "5"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"2.5", " ", 
    SuperscriptBox["10", 
     RowBox[{"-", "5"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", " ", "=", 
   RowBox[{"3", " ", 
    SuperscriptBox["10", 
     RowBox[{"-", "5"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nx", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ny", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nz", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"orig", "[", 
   RowBox[{
   "a_", ",", "b_", ",", "c_", ",", "Nx_", ",", "Ny_", ",", "Nz_", ",", 
    "\[Lambda]_", ",", "w_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Max", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", " ", "Nx"}], ",", 
      RowBox[{"b", " ", "Ny"}], ",", 
      RowBox[{"c", " ", "Nz"}]}], "}"}], "]"}], "/", 
   RowBox[{"\[Theta]div", "[", 
    RowBox[{"\[Lambda]", ",", "w"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.757746363615888*^9, 3.757746520774664*^9}, {
  3.7577467793059893`*^9, 3.757746785266144*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"f174ad88-e374-4c97-8a1f-a5cf1ccd3d06"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"orig", "[", 
  RowBox[{
  "a", ",", "b", ",", "c", ",", "Nx", ",", "Ny", ",", "Nz", ",", "\[Lambda]0",
    ",", 
   RowBox[{"4", " ", 
    SuperscriptBox["10", 
     RowBox[{"-", "6"}]]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.757746788049418*^9, 3.757746819308617*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"bb8a1caf-e252-4d28-811a-9e97f330765b"],

Cell[BoxData["0.00007068583470577034`"], "Output",
 CellChangeTimes->{{3.757746809142617*^9, 3.757746820117288*^9}},
 CellLabel->"Out[35]=",ExpressionUUID->"cc9050aa-c930-4dd3-b3f7-5d08d61f421b"]
}, Open  ]]
},
WindowSize->{1920, 1075},
WindowMargins->{{0, Automatic}, {Automatic, 1}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 3785, 115, 193, "Input",ExpressionUUID->"69075920-6dc6-486e-acfa-ba9cdcd8dab2"],
Cell[CellGroupData[{
Cell[4368, 139, 461, 11, 33, "Input",ExpressionUUID->"fd533328-08c6-4a11-86a0-bb78c8e5d37b"],
Cell[4832, 152, 386, 6, 34, "Output",ExpressionUUID->"590bd861-4bc0-4524-9423-b9bd31f0aee0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5255, 163, 2120, 59, 217, "Input",ExpressionUUID->"9a137cdd-f24b-4eb0-9651-220582abbfc9"],
Cell[7378, 224, 398, 7, 34, "Output",ExpressionUUID->"d75aadc5-44d3-44e9-913d-c889fc24e835"],
Cell[7779, 233, 398, 7, 34, "Output",ExpressionUUID->"af47f7d0-9eea-4da0-aa34-4093d8c7838a"]
}, Open  ]],
Cell[8192, 243, 1299, 38, 157, "Input",ExpressionUUID->"f174ad88-e374-4c97-8a1f-a5cf1ccd3d06"],
Cell[CellGroupData[{
Cell[9516, 285, 376, 9, 33, "Input",ExpressionUUID->"bb8a1caf-e252-4d28-811a-9e97f330765b"],
Cell[9895, 296, 195, 2, 68, "Output",ExpressionUUID->"cc9050aa-c930-4dd3-b3f7-5d08d61f421b"]
}, Open  ]]
}
]
*)

